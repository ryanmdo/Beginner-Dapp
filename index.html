<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Basic Dapp</title>

    <link rel="stylesheet" href="./css/bootstrap.min.css">


  </head>
  <body>

    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center" >
          <h1 >Basic Candidate Dapp</h1>

          <div class="form-group" style="display:inline; margin:20px">
            <div class="input-group">
              <input class="form-control input-lg" id='candidate-form' name="candidateName">
              </input>
              <span class="input-group-btn">
                <button type="submit" id='candidate-form-button' class="btn btn-primary btn-lg">Add Candidate</button>
              </span>
            </div>
          </div>


          <div id="content" class='card' style='width: 600px'>
            <div class="card-header">
              Candidates
            </div>

            <ul class='list-group list-group-flush'>
                <li id="candidateName" class='list-group-item'></li>
            </ul>

          </div>
        </div>
      </div>
    </div>

    <script src="./js/jQuery-3.3.1.min.js" charset="utf-8"></script>
    <script src="./js/bootstrap.min.js" charset="utf-8"></script>
    <script src="./js/web3.min.js" charset="utf-8"></script>
    <script>
      if(typeof web3!= 'undefined'){
        web3= new Web3(web3.currentProvider);
      }else{
        web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));
      }


      web3.eth.defaultAccount = web3.eth.accounts[0];

      var contractAbi = [
	{
		"constant": false,
		"inputs": [
			{
				"name": "_name",
				"type": "string"
			}
		],
		"name": "setCandidate",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "candidateName",
		"outputs": [
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
];

      var contractAddress='0x10b314c756806f7db88ecb14eed5d1a949289be9';

      var contract = web3.eth.contract(contractAbi).at(contractAddress);



      $(document).ready(function(){


        contract.candidateName(function(error, response){
          if(error){
            console.log(error)
          } else {
            $('#candidateName').html(response);
          };
        })


        $('#candidate-form-button').on('click',function(event){
          console.log('#candidate-form pressed')
          event.preventDefault();
          contract.setCandidate($('#candidate-form').val());
        });

      })

    </script>
  </body>
</html>
